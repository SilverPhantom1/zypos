<ion-header [translucent]="true">
  <ion-toolbar>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="contenido-recuperacion" [scrollY]="true">
  <div class="ion-padding contenedor-recuperacion">
    
    <!-- Si el email no se a enviado aun, se muestra formulario -->
    <div *ngIf="!emailEnviado">
      <h2 class="titulo-recuperacion">Recuperar Contraseña</h2>
      <p class="descripcion-recuperacion">
        Ingresa tu email y te enviaremos un enlace para restablecer tu contraseña.
      </p>
      
      <!-- Formulario -->
      <form [formGroup]="formularioRecuperacion" (ngSubmit)="enviarFormulario()">
        
        <!-- Email -->
        <ion-item class="campo-formulario">
          <ion-label position="stacked">Email</ion-label>
          <ion-input 
            type="email" 
            formControlName="email"
            placeholder="tu@email.com">
          </ion-input>
        </ion-item>
        <!-- Mensaje de error para el email -->
        <div *ngIf="formularioRecuperacion.get('email')?.invalid && formularioRecuperacion.get('email')?.touched" 
             class="mensaje-error">
          <span *ngIf="formularioRecuperacion.get('email')?.errors?.['required']">
            El email es requerido
          </span>
          <span *ngIf="formularioRecuperacion.get('email')?.errors?.['email']">
            Ingresa un email válido
          </span>
        </div>

        <!-- Botón para el formulario -->
        <ion-button 
          expand="block" 
          type="submit" 
          class="boton-enviar"
          [disabled]="formularioRecuperacion.invalid || estaCargando">
          <span *ngIf="!estaCargando">Enviar Email</span>
          <span *ngIf="estaCargando">Enviando...</span>
        </ion-button>

        <!-- Boton para volver al login -->
        <div class="link-login">
          <a routerLink="/iniciar-sesion">Volver al inicio de sesión</a>
        </div>

      </form>
    </div>

    <!-- Mensaje que te confirma si el email se envio -->
    <div *ngIf="emailEnviado" class="confirmacion-enviada">
      <div class="icono-exito">
        <ion-icon name="checkmark-circle" size="large"></ion-icon>
      </div>
      <h2 class="titulo-confirmacion">Email Enviado</h2>
      <p class="mensaje-confirmacion">
        Se ha enviado un correo de recuperación a tu dirección de email.
      </p>
      <p class="instrucciones">
        Por favor, revisa tu <strong>bandeja de entrada</strong> y tu <strong>carpeta de spam</strong> para encontrar el email de recuperación.
      </p>
      <p class="instrucciones">
        Haz clic en el enlace del email para restablecer tu contraseña.
      </p>
      
      <!-- Botón para reenviar email -->
      <ion-button 
        expand="block" 
        fill="outline"
        (click)="reenviarEmail()"
        class="boton-reenviar"
        [disabled]="estaCargando">
        <span *ngIf="!estaCargando">Reenviar Email</span>
        <span *ngIf="estaCargando">Reenviando...</span>
      </ion-button>
      
      <!-- Botón para volver al login -->
      <ion-button 
        expand="block" 
        routerLink="/iniciar-sesion"
        class="boton-volver">
        Volver al Inicio de Sesión
      </ion-button>
    </div>

  </div>
</ion-content>
